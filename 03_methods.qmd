# Methodology

## Incident Response in MATSim

In this section, the development of the model for the Utah Incident Management Team (IMT) Optimization project is explored, furthering the discussions presented in sections 2.2 and 2.3 of the literature review. The model is intentionally designed to demonstrate the impacts of traffic incidents on the overall flow of traffic, while also evaluating the integral role of Incident Management Teams (IMTs) within the simulation environment.

This section offers a detailed presentation of the methods used to represent traffic incidents and IMT vehicles within the MATSim framework, with a particular focus on the modifications applied to the agents' behavior, aiming to more accurately emulate real-world conditions. The approach to incident modeling is heavily influenced by and seeks to expand upon the foundational work of @kaddoura2018. Readers seeking a deeper understanding of the methodologies employed in this and similar studies are encouraged to consult The Multi-Agent Transport Simulation (MATSim) textbook.

### Network Change Events

Within the MATSim network, each link is defined by a set of distinct attributes, including link type, length, number of lanes, free-flow speed, and capacity. To replicate unexpected events at particular moments in the simulation, it is necessary to adjust one or more of these attributes. This dynamic adaptability of the network, as expounded in the MATSim textbook, is encapsulated in the concept of a Time-Dependent Network. Events precipitating alterations in the inherent characteristics of the network are labeled as Network Change Events (NCEs).

Section 6.1 of the MATSim textbook outlines how to adapt the parameters of a MATSim configuration file to allow for time-variant network and how to implement network change events. These events can modify a link's free-flow speed, number of lanes, or capacity. To activate a network change event, the system needs to know the time of the event (startTime), the affected link(s) (link refID), the nature of the change (free-flow speed, lanes, or capacity), and the specific value of the change.

Within the context of the Utah IMT optimization problem, changes are triggered when an incident is reported and when an IMT arrives at the affected link. These changes will influence the link's capacity based on the incident data, which will be discussed in more detail in section 3.2.3. Unlike @kaddoura2018 's work, this study does not consider long-term capacity reduction events such as road construction, focusing solely on short-term incidents like accidents or vehicle breakdowns. The diminished capacity of a specific link would typically affect both regular agents (those included in the baseline simulation scenario) and IMT agent vehicles. If a subnetwork is utilized, IMT trucks, similar to other emergency vehicles like ambulances and firetrucks, would be less affected by congestion caused by daily traffic or unexpected incidents.

The implementation of the MATSim within-day replanning module plays a significant role in the rerouting of other agents on the road after an incident.

### Within-Day Replanning

\<\< The concept of within-day replanning is applied to a certain extent in the model, as detailed in Chapter 30 of the MATSim textbook. However, I plan to delve deeper into this concept to ensure its correct application within our study. Subsequently, I will refine the wording of this section to accurately convey its implementation within our model. \>\>

### Vehicle Assignment

When an incident occurs within the MATSim simulation, one or more Incident Management Team (IMT) vehicles are dispatched to manage the situation. A dispatch algorithm determines the most suitable vehicle for the task. The model can select the IMT unit(s) based either on a least-cost path calculation that factors in congestion and link speed or the shortest path between the vehicle's location and the incident site. The chosen method will partially depend on how swiftly the IMT units can navigate through traffic. If a subnetwork is utilized, the IMT trucks would be less affected by congestion and free-flow speed, potentially making the shortest path calculation more suitable. Conversely, if an IMT moves through traffic like a standard vehicle, using a least-cost path calculator within the simulation would likely be the preferred option.

In the context of this project, the Utah IMT system operates in tandem with the Utah Highway Patrol system under the same dispatch service. IMTs in Utah are equipped with sirens and flashing lights similar to those on a highway patrol vehicle, and they operate within specific zones. For instance, there are multiple zones in Salt Lake and Davis Counties where IMT vehicles are distributed. Given that IMTs can navigate traffic like other emergency vehicles, the Utah Highway Patrol dispatch requests the nearest available vehicle(s) to respond to an incident when it occurs. It's worth noting that due to limited resources, an incident ideally requiring assistance from 2 or 3 IMT units may only receive one vehicle, potentially leading to longer management or cleanup times.

## Incident Response

As discussed in Section 3.1.1, a critical element in simulating the effects of incidents on agents within the MATSim network is Network Change Events (NCEs). This mechanism, which illustrates how incidents can impact user behavior, will also be used to demonstrate how the reactions of IMTs influence agents' travel times and paths.

Once the vehicle assignment algorithm dispatches one or more IMT units to an incident, a decision must be made on what percentage of the incident link's capacity is restored upon the IMT's arrival. An arriving IMT can either hasten the restoration of the capacity to normal levels or enhance the capacity by a certain percentage 'X.' These adjustments hinge on the available incident data and findings from other research regarding IMT effectiveness.

@kim2012 discusses the cost-benefit ratio of different IMT fleet sizes, and other studies have attempted to gauge the duration of an incident's impact without an IMT and contrast that with the length of time that an incident affects traffic when an IMT is dispatched. Given the correct information or building upon certain assumptions, one can establish a capacity restoration factor to be applied upon a vehicle's arrival at an incident site.

Figure 4 below provides a potential example of how an incident, with no IMT response, might affect a network in comparison to scenarios where one IMT responds, followed by the response of a secondary unit.

![Figure 4: Changes upon arrival.](figures/fig4.png)

## Simulation Scenarios

Loading incidents and IMT response vehicles into the Utah Optimization model is a significant aspect of this project's methodology. Another crucial element involves running scenarios to quantify the impact of both incidents and IMT arrivals. Various factors influence these quantitative comparisons. These include the type of network and plans files used during the simulation, the processed and selected incident data, and the locations and quantities of IMT vehicles included in the simulations. Each of these components builds on prior research related to IMTs in Utah, MATSim studies on Demand Responsive Transport (DRT), and transportation modeling research conducted by the Wasatch Front Regional Council in various traffic modeling projects throughout Utah.

### Wasatch Front Base Scenario

In this section, we aim to outline the origins of the network and plans file and their usage in other research conducted by the Wasatch Front Regional Council (WFRC).

\<\< Dr. Macfarlane has provided information about the source of these plans. I will review his notes before expanding this section. \>\>

The network and plans have been calibrated and represent a typical day's traffic in the regions where most IMT vehicles operate.

### Incident & IMT Scenario

We will detail the various scenarios we executed in this section, specifying the types based on the number of incidents and the quantity of Incident Management Teams (IMTs) involved. We will clarify why we chose to execute the specific number of tests and scenarios.

\<\< Brynn has prepared a table detailing these different scenario types, which we could include here if desired. \>\>

Essentially, we have six scenarios:

1\. A baseline with no IMTs.

2\. A baseline with no IMTs and increased incident frequency.

3\. Current IMT resources with current incident frequency.

4\. Current IMT resources with increased incident frequency.

5\. Improved (added) IMT resources with the current frequency of incidents.

6\. Improved IMT resources with increased frequency of incidents.

Our goal is to run at least ten days of simulations for each scenario.

### Incident Data

\<\< TO DO: summarize the methodology used by Joel Hyer and to describe where our incident data came from \>\>

### Incident Sampling

To determine the appropriate modeling of incidents for a given day, reflecting the current incident frequency, we analyzed the received incident data to create a distribution of incident count frequency for sampling.

We wrote code using Pandas in Python to read data into a data frame, remove duplicate entries, and manipulate the 'Call Received Time' and 'Call Type' columns. The data frame is then grouped by date and call type to count incidents. The result is a new data frame showing incident frequency per day. These frequencies are used to create a weighted distribution for sampling. To ensure reproducibility, the code utilizes a random seed value and performs random sampling by selecting ten days from the incident number distribution based on the calculated frequencies. The sample yields ten values that will be utilized in MATSim to determine the number of incidents to be generated in the simulation for ten different simulated days.

For our increased frequency scenarios, we aimed to assess the impact of a significant surge in daily incidents on the IMT system. To achieve this, we used the higher end of the 2022 data as a reference, including one day with 21 incidents, one with 20 incidents, two with 19 incidents, and two with 18 incidents. This approach allowed us to test the effectiveness and coverage of the IMT program under more extreme demand. Because this collection is limited to 6 days, we included one additional day of each incident count, choosing to simulate two days with 21 incidents, two days with 20 incidents, three days with 19 incidents, and three days with 18 incidents.

![Figure 5: Incident Sampling.](figures/fig5.png)

### Comparative Measures

\<\< TO DO: Rewrite this section. Make it sound more academic. The goal is to provide a transition from the methodology to the results section of the paper \>\>

As we transition from the methodology to the results, it is essential to underscore the measures employed for an exhaustive comparative analysis. Central to our examination is the metric of total vehicle hours of delay. While of considerable import, the average IMT vehicle arrival time assumes a secondary role in our analysis. Emphasis will be placed on delay durations for both incident and feeder links; the latter being defined as the connecting routes leading to incident sites.

Our inquiry extends to the variance in delay durations across diverse scenarios. We have systematically categorized the links according to their intrinsic types. A salient metric targets delay durations associated with 'motorway type' links. Concurrently, a comprehensive metric will delineate the total delay span across the entire network. It is paramount to recognize that while this overarching delay duration might be influenced by our adjustments to the MATSim model, other external variables could also play a role.

The forthcoming results section will elucidate these measures in detail, accentuating any modifications we've incorporated into the model. What follows should be regarded as a concise prologue, prepping the reader for an in-depth analytical exposition.
